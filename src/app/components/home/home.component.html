<div class="head-container">
  <h1>Bathroom-a-sketch</h1>
</div>
<div class="main-container">
     <div>
      <div class="predefined-objects">
        <div class="sidebar">
          <h3 (click)="toggleConfigurations()" class="collapsible-header">Configurations
            <span class="arrow">{{ showConfigurations ? '▲' : '▼' }}</span>
          </h3>
          <div *ngIf="showConfigurations">
          <input type="string" [(ngModel)]="newSaveName" (input)="updateSizeInCm()" />
          <ul>
            <button class="savebutton" (click)="saveConfiguration(newSaveName)">Save</button>
            <li *ngFor="let config of savedConfigurations" (click)="loadConfiguration(config.name)">
              {{ config.name }}
              <button class="deletebutton" (click)="deleteConfiguration(config.name)">X</button>
            </li>
          </ul>
          </div>
        </div>
        <h3 (click)="toggleGridSize()" class="collapsible-header">Grid Size
          <span class="arrow">{{ showGridSize ? '▲' : '▼' }}</span>
        </h3>
        <div *ngIf="showGridSize">
        <div class="form-group">
          <label for="gridX">Grid Width (X):</label>
          <input type="number" id="gridX" [(ngModel)]="gridX" (input)="updateGridSize(gridX, gridY)" min="1" />
        </div>
        <div class="form-group">
          <label for="gridY">Grid Height (Y):</label>
          <input type="number" id="gridY" [(ngModel)]="gridY" (input)="updateGridSize(gridX, gridY)" min="1" />
        </div>
        </div>
    <form [formGroup]="objectForm">
      <h3 (click)="toggleCreateObject()" class="collapsible-header">Create object
        <span class="arrow">{{ showGridSize ? '▲' : '▼' }}</span>
      </h3>
      <div *ngIf="showCreateObject">
      <div class="form-group">
        <label for="width">Name:</label>
        <input type="string" id="name" formControlName="name" />
      </div>

      <div class="form-group">
        <label for="width">Width (cm):</label>
        <input type="number" id="width" formControlName="width" min="1" />
      </div>
    
      <div class="form-group">
        <label for="height">Height (cm):</label>
        <input type="number" id="height" formControlName="height" min="1" />
      </div>
    
      <div class="form-group">
        <label for="image">image:</label>
        <input type="string" id="image" formControlName="image" />
      </div>

      <!-- <div class="form-group">
        <label>
          <input type="checkbox" formControlName="mustTouchWall" />
          Must Touch Wall
        </label>
      </div> -->
      <button (click)="onSubmit()" [disabled]="objectForm.invalid">Add Object</button>
      </div>
    </form>
    <div class="sidebar">
      <h3 (click)="togglePredefinedObjects()" class="collapsible-header">Predefined objects
        <span class="arrow">{{ showPredefinedObjects ? '▲' : '▼' }}</span>
      </h3>
      <div *ngIf="showPredefinedObjects">
        <ul>
          <li *ngFor="let object of predefinedItems" (click)="addPredefinedItem(object)" [class.selected]="selectedItem?.name === object.name">
            {{ object.name }} - {{ object.width / 3 }}x{{ object.height / 3 }}
          </li>
        </ul>
      </div>
    </div>

    <div class="sidebar">
      <h3 (click)="toggleAvailableObjects()" class="collapsible-header">Available Objects
        <span class="arrow">{{ showAvailableObjects ? '▲' : '▼' }}</span>
      </h3>
      <div *ngIf="showAvailableObjects">

      <ul>
        <li
          *ngFor="let object of items"
          [class.selected]="selectedItem?.name === object.name && selectedItem?.x === object.x"
          (click)="selectItem(object)"
        >
          {{ object.name }} - {{ object.width / 3 }}x{{ object.height / 3 }}
          <button class="deletebutton" (click)="removeObject(object); $event.stopPropagation();">
            X
          </button>
        </li>
      </ul>
      </div>
    </div>

    <div *ngIf="selectedItem">
      <h3 (click)="toggleResize()" class="collapsible-header">Resize {{ selectedItem.name }}
        <span class="arrow">{{ showResize ? '▲' : '▼' }}</span>
      </h3>
      <div *ngIf="showResize">
        <div class="form-group">
          <label for="width">Width (cm):</label>
          <input type="number" [(ngModel)]="inputWidthCm" (input)="updateSizeInCm()" />
        </div>
      
        <div class="form-group">
          <label for="height">Height (cm):</label>
          <input type="number" [(ngModel)]="inputHeightCm" (input)="updateSizeInCm()" />
        </div>
      </div>
    </div>

  </div>

     </div>
     <div class="example-boundary" [style.width.px]="boundaryWidth" [style.height.px]="boundaryHeight">
       <div class="grid-background" [style.gridTemplateColumns]="'repeat(' + gridX + ', ' + gridCellSize + 'px)'" [style.gridTemplateRows]="'repeat(' + gridY + ', ' + gridCellSize + 'px)'">
         <div *ngFor="let cell of gridCells; let i = index" 
               class="grid-cell" 
               [ngClass]="{'clicked': cell.isClicked}" 
               (mousedown)="onMouseDown(i)"
               (mouseup)="onMouseUp()"
               (mouseover)="onMouseOver(i)">
         </div>
         <div class="example-box"
              cdkDragBoundary=".example-boundary"
              cdkDrag
              *ngFor="let item of items" 
              [id]="item.name"
              [ngStyle]="{
               'transform': (item.firstLoadConfiguration ? 'translate3d(' + item.x + 'px, ' + item.y + 'px, 0)' : '(' + 0 + 'px, ' + 0 + 'px, 0)' ),
               'background-color': checkCollisionWithGridCells(item) ? 'rgba(134, 22, 22, 0.6)' : (item.isColliding ? 'rgba(134, 22, 22, 0.6)' : 'rgba(255, 255, 255, 0.85)')            
               }"
              [style.width.px]="item.width"
              [style.height.px]="item.height"
              (cdkDragMoved)="onDrag($event, item)"
              (mousedown)="selectItem(item)">
            <button class="rotate-button" (click)="rotateObject()">&#10227;</button>
            <img
              [src]="item.image"
              alt="{{ item.name }}"
              class="object-image"
              [ngStyle]="{
                'transform': 'rotate(' + item.rotation + 'deg)',
                'width.px': item.rotation === 90 || item.rotation === 270 ? item.height : item.width,
                'height.px': item.rotation === 90 || item.rotation === 270 ? item.width : item.height
              }">
           {{ item.name }}
         </div>
       </div>
   
     </div>

  </div>


